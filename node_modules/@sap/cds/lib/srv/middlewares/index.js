const auth      = exports.auth      = require('../../auth')
const context   = exports.context   = require('./cds-context')
const ctx_model = exports.ctx_model = require('./ctx-model')
const errors    = exports.errors    = require('./errors')
const trace     = exports.trace     = require('./trace')

// middlewares running before protocol adapters
exports.before = [
  trace(),    // provides detailed trace logs when DEBUG=trace
  auth(),     // provides req.user & tenant
  context(),  // provides cds.context
  ctx_model(),    // fills in cds.context.model
]

exports.after = [
  // usually error middlewares
  errors(),
]

exports.bootstrap = ()=>{
  require('../protocols')()
}
